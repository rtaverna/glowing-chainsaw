"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react");function e(){return(e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var i=[];function n(t,e){return function(){e(t,this.naturalWidth,this.naturalHeight)}}function r(t){return t[0]}function a(t,e){return t.filter((function(t){return t!==e}))}function o(t,e){return t.reduce((function(t,i,n){return t>=0?t:e(i)?n:t}),-1)}exports.default=function(h){var c,s;function d(i){var n;(n=h.call(this,i)||this).containerRef=t.createRef(),n.onResize=function(){n.containerRef&&n.containerRef.current&&n.setState({containerWidth:n.containerRef.current.offsetWidth,containerHeight:n.containerRef.current.offsetWidth})},n.handleImageClick=function(t){n.props.onImageClick&&n.props.onImageClick(t)},n.recalculateGrid=function(t,e,i){var h=[].concat(n.state.imagesToShow),c=o(h,(function(e){return e.id===t}));h[c].width=e,h[c].height=i;var s,d=0,u={width:n.state.containerWidth,height:n.state.containerHeight},f=["Width","Height"],g=f[n.state.ladyLuck].toLowerCase(),l=r(a(f,f[n.state.ladyLuck])).toLowerCase();if(s=function(t){return!(!t.width||!t.height)},h.reduce((function(t,e){return s(e)&&t}),!0)){var p=function(t,e){return t.reduce((function(t,i){return e(i)>e(t)?i:t}),t[0])}(h,(function(t){return t[g]}));d=o(h,(function(t){return t.id===p.id})),h[d][g]<u[g]&&(u[g]=h[d][g],u[l]=u[g]);var m=h.reduce((function(t,e,i){return e[g]>=u[g]&&e[g]/e[l]>h[t][g]/h[t][l]?i:t}),0);h.push.apply(h,h.splice(0,m)),n.setState({imagesToShow:h,containerHeight:u.height,containerWidth:u.width})}},n.getComponentStyles=function(t){var i=t.length,o=["Bottom","Right"],h=["Width","Height"],c=h[n.state.ladyLuck],s=r(a(h,c)),d=o[n.state.ladyLuck],u=r(a(o,d)),f=Math.floor(n.state["container"+c]/(i-1))-2,g=[],l={display:"inline-block",position:"relative",overflow:"hidden",float:"left",verticalAlign:"top",cursor:"pointer"};switch(i){case 0:break;case 1:t[0].width||(t[0].width=1e6),t[0].height||(t[0].height=1e6),g=t[0].width>t[0].height?[{width:Math.min(n.state.containerWidth,t[0].width)-2,height:Math.min(n.state.containerWidth,t[0].width)*t[0].height/t[0].width-2,margin:2}]:[{width:Math.min(n.state.containerHeight,t[0].height)*t[0].width/t[0].height-2,height:Math.min(n.state.containerHeight,t[0].height)-2,margin:2}];break;case 2:g[0]=g[1]={},g[0][c.toLowerCase()]=g[1][c.toLowerCase()]=n.state["container"+c]-2,g[0][s.toLowerCase()]=g[1][s.toLowerCase()]=Math.min(f/2)-2,g[0]["margin"+d]=2;break;default:g[0]={},g[0][c.toLowerCase()]=n.state["container"+c],g[0][s.toLowerCase()]=f*(i-2),g[0]["margin"+d]=2;var p={width:f,height:f};p["margin"+u]=2;for(var m=1;m<i&&m<4;m++)g.push(e({},p));g[i-1][c.toLowerCase()]+=g[0][c.toLowerCase()]-f*(i-1)-2*(i-2),g[i-1]["margin"+u]=0}return g.map((function(t){return e(e({},l),t)}))};var c=500,s=500;if(n.props.gridSize){var d=n.props.gridSize.split("x");c=parseInt(d[0],10)||500,s=parseInt(d[1],10)||500}var u,f=n.props.data.length<=4?n.props.data:n.props.data.slice(0,4);u=f.map(f[0]&&"string"==typeof f[0]?function(t){return{id:""+1e3*Math.random(),src:t,width:0,height:0}}:function(t){return e(e({id:t.id||""+1e3*Math.random(),src:t.src},t),{},{width:0,height:0})});var g={ladyLuck:Math.floor(2*Math.random()),containerWidth:c,containerHeight:s,imagesToShow:u};return n.props.containerWidth&&(g.containerWidth=n.props.containerWidth),n.state=g,n}s=h,(c=d).prototype=Object.create(s.prototype),c.prototype.constructor=c,c.__proto__=s;var u=d.prototype;return u.componentWillUnmount=function(){var t=this;i.forEach((function(e){e.removeEventListener("load",n(e.id,t.recalculateGrid))}))},u.componentDidMount=function(){var t=this;this.state.imagesToShow.forEach((function(e){var r,a,o,h;r=e.src,a=e.id,o=t.recalculateGrid,(h=new Image).id=a,i.push(h),h.addEventListener("load",n(a,o)),h.src=r}),this),!this.props.gridSize&&this.containerRef&&this.containerRef.current&&this.setState({containerWidth:this.containerRef.current.offsetWidth,containerHeight:this.containerRef.current.offsetWidth})},u.render=function(){var e=this,i=this.getComponentStyles(this.state.imagesToShow),n=this.state.imagesToShow.map((function(n,r){var a,o=i[r];return n.width&&n.height&&o.width&&o.height&&(n.width<=o.width||n.height<=o.height||(a=n.width/o.width<n.height/o.height?{maxWidth:o.width}:{maxHeight:o.height})),t.createElement("div",{key:"image_"+r,style:o},t.createElement("img",{style:a,src:n.src,onClick:function(){return e.handleImageClick(n.src)}}))}),this);return t.createElement("div",null,t.createElement("div",{style:{width:this.state.containerWidth,height:this.state.containerWidth,backgroundColor:"white"}},n,t.createElement("div",{style:{clear:"both"}})))},d}(t.Component);
//# sourceMappingURL=react-photo-grid.cjs.production.min.js.map
